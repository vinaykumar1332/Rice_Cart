let slideIndex=0;const slides=document.querySelectorAll(".slide");function showSlide(e){slides.forEach(((t,o)=>{t.classList.toggle("active",o===e)}))}function autoSlide(){slideIndex=(slideIndex+1)%slides.length,showSlide(slideIndex)}setInterval(autoSlide,5e3),showSlide(slideIndex),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("carousel"),t=document.getElementById("prev-btn"),o=document.getElementById("next-btn");let s;const n=5,r=document.createElement("div");function c(e,t="error"){const o=document.createElement("div");o.className=`toast ${t}`,o.textContent=e,r.appendChild(o),setTimeout((()=>{o.style.opacity="1"}),100),setTimeout((()=>{o.style.opacity="0",setTimeout((()=>o.remove()),300)}),3e3)}function a(e){for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}return e}async function i(){if(navigator.onLine||(c("No internet connection"),0)){!function(){e.innerHTML="";for(let t=0;t<n;t++){const t=document.createElement("div");t.className="skeleton-card",t.innerHTML='\n            <div class="skeleton-img"></div>\n            <div class="skeleton-text"></div>\n            <div class="skeleton-text"></div>\n            <div class="skeleton-text short"></div>\n            <div class="skeleton-text short"></div>\n          ',e.appendChild(t)}}();try{const e=await fetch("https://script.google.com/macros/s/AKfycbzWIlg4U6L71j2jIOxt0Jh6EKvUSDbvrKf7F4AtsbLzY5_YZXjCj_nJ-0wMOjkpHY-G/exec",{cache:"no-store"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json(),o=Array.isArray(t)?t.slice(0,10).map((e=>({ID:String(e.ID||""),Brand:String(e.Brand||"N/A"),Name:String(e.Name||"N/A"),Type:String(e.Type||"N/A"),PricePerKg:parseFloat(e.PricePerKg)||0}))):[];if(0===o.length)throw new Error("No valid product data received");const s=a([...o]);try{const e=JSON.stringify(s);if(new Blob([e]).size>5242880)throw new Error("Data too large for sessionStorage");sessionStorage.setItem("carouselProducts",e),console.log("Carousel products saved to sessionStorage"),c("Carousel products saved to session storage","success")}catch(e){console.error("Error saving to sessionStorage:",e),c(`Failed to save carousel products: ${e.message}`,"error")}l(s),d(),m()}catch(t){console.error("Failed to fetch product data:",t),e.innerHTML=`<p style="padding:10px; color: var(--color-error);">Unable to load products: ${t.message}</p>`}}else e.innerHTML='<p style="padding:10px; color: var(--color-error);">No internet connection</p>'}function l(t){e.innerHTML="",t.forEach(((t,o)=>{const s=document.createElement("div");var n;s.className="card",s.style.opacity="0",s.style.transform="translateY(20px)",s.innerHTML=`\n            <img src="${n=t.ID,`./src/assets/images/${n}.jpg`}" alt="${t.Name}" onerror="this.src='./src/assets/images/default.jpg';" />\n            <div class="card-content">\n            <h3 class="type">${t.Type}</h3>\n            <p class="name">${t.Name}</p>\n            <p class="price">â‚¹${t.PricePerKg}/kg</p>\n            </div>\n          `,e.appendChild(s),setTimeout((()=>{s.style.opacity="1",s.style.transform="translateY(0)"}),100*(o+1))}))}function d(){const s=e.scrollLeft,n=e.scrollWidth-e.clientWidth;t.disabled=s<=0,o.disabled=s>=n}function u(t){const o=e.querySelector(".card")?.offsetWidth||(window.innerWidth<=768?180:240);e.scrollBy({left:t*(o+16),behavior:"smooth"}),setTimeout(d,300)}function m(){s&&clearInterval(s);const t=e.querySelector(".card")?.offsetWidth||(window.innerWidth<=768?180:240);let o=0;s=setInterval((()=>{e.scrollBy({left:t+16,behavior:"smooth"}),o+=t+16,o>=e.scrollWidth-e.clientWidth&&(o=0,e.scrollTo({left:0,behavior:"smooth"})),d()}),3500),e.addEventListener("mouseenter",(()=>clearInterval(s))),e.addEventListener("mouseleave",m)}r.className="toast-container",document.body.appendChild(r),t.addEventListener("click",(()=>u(-1))),o.addEventListener("click",(()=>u(1))),e.addEventListener("scroll",d);const p=sessionStorage.getItem("carouselProducts");if(p)try{const e=JSON.parse(p);l(a([...e])),d(),m(),c("Loaded carousel products from cache","success")}catch(e){console.error("Error loading cached products:",e),i()}else i();window.addEventListener("online",(()=>{c("Back online","success"),i()})),window.addEventListener("offline",(()=>{c("Lost internet connection")}))}));